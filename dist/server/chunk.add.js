exports.ids=[3],exports.modules={81:function(e,t){e.exports={add_detail:"_2cv-NkQb",addDetail:"_2cv-NkQb",add_input:"_3cz4YFf_",addInput:"_3cz4YFf_",add_img:"_3eSq6rnj",addImg:"_3eSq6rnj",add_title:"_3laORU9X",addTitle:"_3laORU9X",add_tag:"_35S9-dKI",addTag:"_35S9-dKI",add_desc:"_2BJdJvBf",addDesc:"_2BJdJvBf",upHtml:"_KZarKDS"}},180:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(28),s=n(d);a(29);a(81);var u=function(e){function t(e){i(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={tagvalue:"",title:"",desc:"",process:0,imgpath:"",isimgpath:-1},a}return o(t,e),r(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){huch.loadScript("/common/editor/wangEditor.js",function(){var e=new wangEditor("editor");e.config.uploadImgUrl="/upimage",e.create()})}},{key:"updata",value:function(e){var t=$("#editor").html(),a=this.state;return""==a.imgpath?void alert("请上传封面图片"):void huch.post("/api/add",{title:a.title,tag:a.tagvalue,desc:a.desc,text:t,imgpath:a.imgpath,time:(new Date).getTime()},function(e){0==e.code?window.location.href="/":alert("数据库保存失败")})}},{key:"inputChange",value:function(e,t){var a=t.target.value,n=this.state;n[e]=a,this.setState({})}},{key:"upimg",value:function(e){var t=this,a=e.target.files;if(a.length){var n=new FormData;console.log(a[0]),n.append("upload",a[0]);var i=new XMLHttpRequest;i.open("POST","/upimage"),i.upload.onprogress=function(e){if(e.lengthComputable){var a=e.loaded/e.total*100|0;t.setState({isimgpath:0,process:a})}},i.onload=function(){200===i.status?(console.log("上传成功"),t.setState({imgpath:i.response,isimgpath:1})):console.log("出错了")},i.send(n)}}},{key:"render",value:function(){var e=this.state.isimgpath;return s.default.createElement("div",{className:"add_detail"},s.default.createElement("div",{className:"add_con clearfix"},s.default.createElement("div",{className:"add_input fl"},s.default.createElement("div",{className:"add_title"},s.default.createElement("span",{className:"tit_name"},"标题:"),s.default.createElement("input",{defaultValue:this.state.tagvalue,onChange:this.inputChange.bind(this,"title")})),s.default.createElement("div",{className:"add_tag"},s.default.createElement("span",{className:"tag_name"},"标签:"),s.default.createElement("input",{defaultValue:this.state.tagvalue,onChange:this.inputChange.bind(this,"tagvalue")})),s.default.createElement("div",{className:"add_desc"},s.default.createElement("span",{className:"desc_name"},"简介:"),s.default.createElement("textarea",{defaultValue:this.state.tagvalue,onChange:this.inputChange.bind(this,"desc")}))),s.default.createElement("div",{className:"add_img fl"},e==-1?"封面图片上传":0==e?this.state.process+"%":s.default.createElement("span",null,s.default.createElement("img",{src:this.state.imgpath})),s.default.createElement("input",{type:"file",onChange:this.upimg.bind(this)}))),s.default.createElement("div",{id:"editor",style:{"min-height":"500px"}}),s.default.createElement("div",{className:"upHtml",onClick:this.updata.bind(this)},"提交"))}}]),t}(d.Component);e.exports=u}};